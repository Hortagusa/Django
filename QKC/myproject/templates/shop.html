{% extends 'base.html' %} {% load static %} {% block body_block %}

<!-- HERO -->
<div
  class="hero-wrap hero-bread"
  style="background-image: url('{% static 'images/bg_1.jpg' %}')"
>
  <div class="container">
    <div
      class="row no-gutters slider-text align-items-center justify-content-center"
    >
      <div class="col-md-9 ftco-animate text-center">
        <p class="breadcrumbs">
          <span class="mr-2"><a href="{% url 'index' %}">Home</a></span>
          <span>Products</span>
        </p>
        <h1 class="mb-0 bread">Products</h1>
      </div>
    </div>
  </div>
</div>

<!-- SHOP -->
<section class="ftco-section">
  <div class="container">
    <!-- CATEGORY + ADD BUTTON -->
    <div class="row justify-content-center">
      <div class="col-md-10 mb-5 text-center">
        <ul class="product-category">
          <li><a href="#" class="active">All</a></li>
          <li><a href="#">Vegetables</a></li>
          <li><a href="#">Fruits</a></li>
          <li><a href="#">Juice</a></li>
          <li><a href="#">Dried</a></li>
        </ul>

        <!-- ADD PRODUCT -->
        <div class="mt-4">
          <a
            href="{% url 'myapp:add_shop' %}"
            class="btn btn-primary px-4 py-2"
          >
            ‚ûï Th√™m s·∫£n ph·∫©m
          </a>
        </div>
      </div>
    </div>

    <!-- PRODUCT LIST -->
    <div class="row">
      {% if products %} {% for product in products %}
      <div class="col-md-6 col-lg-3 ftco-animate">
        <div class="product">
          <!-- IMAGE -->
          <a href="{% url 'product-single' product.id %}" class="img-prod">
            <img
              class="img-fluid"
              style="height: 200px; object-fit: cover"
              src="{{ product.image }}"
              alt="{{ product.name }}"
            />
          </a>

          <!-- INFO -->
          <div class="text py-3 pb-4 px-3 text-center">
            <h3>
              <a href="{% url 'product-single' product.id %}">
                {{ product.name }}
              </a>
            </h3>

            <div class="d-flex">
              <div class="pricing">
                <p class="price">
                  <span class="mr-2">${{ product.price }}</span>
                </p>
              </div>
            </div>

            <!-- ACTION BUTTONS -->
            <div class="bottom-area d-flex px-3">
              <div class="m-auto d-flex">
                <!-- VIEW -->
                <a
                  href="{% url 'product-single' product.id %}"
                  class="add-to-cart d-flex justify-content-center align-items-center text-center"
                  title="Xem chi ti·∫øt"
                >
                  <span><i class="ion-ios-eye"></i></span>
                </a>

                <!-- EDIT -->
                <a
                  href="{% url 'myapp:edit_shop' product.id %}"
                  class="buy-now d-flex justify-content-center align-items-center mx-1"
                  title="S·ª≠a"
                  style="background: #ffc107"
                >
                  <span><i class="ion-ios-create"></i></span>
                </a>

                <!-- DELETE -->
                <a
                  href="{% url 'myapp:delete_shop' product.id %}"
                  class="heart d-flex justify-content-center align-items-center"
                  title="X√≥a"
                  style="background: #dc3545; color: white"
                >
                  <span><i class="ion-ios-trash"></i></span>
                </a>
              </div>
            </div>
          </div>
          <div class="d-flex justify-content-center mt-3">
          <button
            class="btn btn-primary cart-btn"
            data-id="{{ product.id }}"
            data-name="{{ product.name }}"
            data-price="{{ product.price }}"
            data-image="{{ product.image }}"
          >
            Add To Cart
          </button>
        </div>
        </div>
      </div>
      {% endfor %} {% else %}
      <div class="col-12 text-center">
        <p>‚ùå No products available.</p>
      </div>
      {% endif %}
    </div>
  </div>
</section>

<!-- NEWSLETTER -->
<section class="ftco-section ftco-no-pt ftco-no-pb py-5 bg-light">
  <div class="container py-4">
    <div class="row d-flex justify-content-center py-5">
      <div class="col-md-6">
        <h2 style="font-size: 22px" class="mb-0">
          Subscribe to our Newsletter
        </h2>
        <span
          >Get e-mail updates about our latest shops and special offers</span
        >
      </div>
      <div class="col-md-6 d-flex align-items-center">
        <form action="#" class="subscribe-form">
          <div class="form-group d-flex">
            <input
              type="text"
              class="form-control"
              placeholder="Enter email address"
            />
            <input type="submit" value="Subscribe" class="submit px-3" />
          </div>
        </form>
      </div>
    </div>
  </div>
</section>
<div id="toast" class="toast-notification">
  üõí ƒê√£ th√™m v√†o gi·ªè h√†ng
</div>

<script>
    function showToast(message) {
      const toast = document.getElementById("toast");
      toast.innerText = message;
      toast.classList.add("show");

      setTimeout(() => {
        toast.classList.remove("show");
      }, 2500);
    }
  if (localStorage.getItem("cart") == null) {
    var cart = {};
  } else {
    cart = JSON.parse(localStorage.getItem("cart"));
  }

  document.querySelectorAll(".cart-btn").forEach((btn) => {
    btn.addEventListener("click", function () {
      let id = this.dataset.id;
      let name = this.dataset.name;
      let price = parseFloat(this.dataset.price);
      let image = this.dataset.image;

      if (cart[id]) {
        cart[id][0] += 1;
      } else {
        cart[id] = [1, name, price, image];
      }

      localStorage.setItem("cart", JSON.stringify(cart));
      showToast("üõí ƒê√£ th√™m v√†o gi·ªè h√†ng");
    });
  });

</script>
{% endblock %}
